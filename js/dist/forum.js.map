{"version":3,"sources":["webpack://@fof/upload/webpack/bootstrap","webpack://@fof/upload/./forum.js","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/upload/./src/forum/addUploadButton.js","webpack://@fof/upload/./src/forum/components/DragAndDrop.js","webpack://@fof/upload/./src/forum/components/PasteClipboard.js","webpack://@fof/upload/./src/forum/components/UploadButton.js","webpack://@fof/upload/./src/forum/downloadButtonInteraction.js","webpack://@fof/upload/./src/forum/handler/Uploader.js","webpack://@fof/upload/./src/forum/index.js","webpack://@fof/upload/external \"flarum.core.compat['Component']\"","webpack://@fof/upload/external \"flarum.core.compat['app']\"","webpack://@fof/upload/external \"flarum.core.compat['components/EditPostComposer']\"","webpack://@fof/upload/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/upload/external \"flarum.core.compat['components/Post']\"","webpack://@fof/upload/external \"flarum.core.compat['components/ReplyComposer']\"","webpack://@fof/upload/external \"flarum.core.compat['components/TextEditor']\"","webpack://@fof/upload/external \"flarum.core.compat['extend']\"","webpack://@fof/upload/external \"flarum.core.compat['helpers/icon']\"","webpack://@fof/upload/external \"flarum.core.compat['utils/Stream']\""],"names":["extend","TextEditor","prototype","uploader","Uploader","items","app","forum","attribute","button","UploadButton","component","upload","files","on","success","add","f_","vnode","image","attrs","composer","editor","insertAtCursor","dragAndDrop","DragAndDrop","$","parents","unloadHandler","unload","bind","PasteClipboard","composerElement","handlers","supportsFileDragging","addEventListener","out","dropping","isDropping","over","div","document","createElement","window","removeEventListener","isNotFile","event","dataTransfer","i","length","kind","preventDefault","classList","remove","textAreaElement","paste","e","clipboardData","type","indexOf","push","getAsFile","oninit","uploading","Stream","view","buttonText","translator","trans","m","className","LoadingIndicator","size","icon","multiple","onchange","process","prop","console","log","ReplyComposer","route","set","discussion","props","EditPostComposer","post","setTimeout","reset","redraw","Component","Post","isInitialized","unbind","stopPropagation","alert","url","currentTarget","dataset","fofUploadDownloadUuid","id","session","csrfToken","open","callbacks","callback","dispatch","response","forEach","body","FormData","append","request","method","serialize","raw","then","uploaded","file","initializers","addUploadButton","downloadButtonInteraction"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport TextEditor from 'flarum/components/TextEditor';\nimport UploadButton from './components/UploadButton';\nimport DragAndDrop from './components/DragAndDrop';\nimport PasteClipboard from './components/PasteClipboard';\nimport Uploader from \"./handler/Uploader\";\n\nexport default function () {\n    extend(TextEditor.prototype, 'oninit', function () {\n        this.uploader = new Uploader();\n    })\n    extend(TextEditor.prototype, 'controlItems', function (items) {\n        if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n        let button = UploadButton.component({\n            upload: files => this.uploader.upload(files)\n        });\n\n        this.uploader.on('uploaded', () => button.success());\n\n        items.add('fof-upload', button);\n    });\n\n    extend(TextEditor.prototype, 'oncreate', function (f_, vnode) {\n        if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n        this.uploader.on('success', image => this.attrs.composer.editor.insertAtCursor(image + '\\n'));\n\n        const dragAndDrop = new DragAndDrop(\n            files => this.uploader.upload(files),\n            this.$().parents('.Composer')[0]\n        );\n\n        const unloadHandler = () => {\n            dragAndDrop.unload();\n        };\n\n        this.$('textarea').bind('onunload', unloadHandler);\n\n        new PasteClipboard(\n            files => this.uploader.upload(files),\n            this.$('textarea')[0]\n        );\n    });\n}\n","export default class DragAndDrop {\n    constructor(upload, composerElement) {\n        this.upload = upload;\n        this.composerElement = composerElement;\n\n        // Keep references to the bound methods so we can remove the event listeners later\n        this.handlers = {};\n\n        if (!this.supportsFileDragging()) {\n            return;\n        }\n\n        this.composerElement.addEventListener('dragover', this.handlers.in = this.in.bind(this));\n\n        this.composerElement.addEventListener('dragleave', this.handlers.out = this.out.bind(this));\n        this.composerElement.addEventListener('dragend', this.handlers.out);\n\n        this.composerElement.addEventListener('drop', this.handlers.dropping = this.dropping.bind(this));\n\n        this.isDropping = this.over = false;\n    }\n\n    supportsFileDragging() {\n        // Based on https://css-tricks.com/drag-and-drop-file-uploading/\n        const div = document.createElement('div');\n\n        return (('draggable' in div) || ('ondragstart' in div && 'ondrop' in div)) && 'FormData' in window && 'FileReader' in window;\n    }\n\n    unload() {\n        // If the handlers were not set (drag and drop not supported), we skip removing them\n        if (!this.handlers.in) {\n            return;\n        }\n\n        this.composerElement.removeEventListener('dragover', this.handlers.in);\n\n        this.composerElement.removeEventListener('dragleave', this.handlers.out);\n        this.composerElement.removeEventListener('dragend', this.handlers.out);\n\n        this.composerElement.removeEventListener('drop', this.handlers.dropping);\n    }\n\n    isNotFile(event) {\n        // Checking event.dataTransfer.files.length does not work on dragover event, it's always zero\n        // So we use the dataTransfer.items property to check whether any file is being dragged\n        if (event.dataTransfer.items) {\n            for (let i = 0; i < event.dataTransfer.items.length; i++) {\n                if (event.dataTransfer.items[i].kind !== 'file') {\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    in(event) {\n        if (this.isNotFile(event)) {\n            return;\n        }\n\n        event.preventDefault();\n\n        if (!this.over) {\n            this.composerElement.classList.add('fof-upload-dragging');\n            this.over = true;\n        }\n    }\n\n    out(event) {\n        if (this.isNotFile(event)) {\n            return;\n        }\n\n        event.preventDefault();\n\n        if (this.over) {\n            this.composerElement.classList.remove('fof-upload-dragging');\n            this.over = false;\n        }\n    }\n\n    dropping(event) {\n        if (this.isNotFile(event)) {\n            return;\n        }\n\n        event.preventDefault();\n\n        if (!this.isDropping) {\n            this.isDropping = true;\n            this.composerElement.classList.add('fof-upload-dropping');\n\n            this.upload(event.dataTransfer.files, () => {\n                this.composerElement.classList.remove('fof-upload-dropping');\n                this.isDropping = false;\n            })\n        }\n    }\n}\n","export default class PasteClipboard {\n    constructor(upload, textAreaElement) {\n        this.upload = upload;\n\n        // We don't need to remove the events listeners, because they are bound to the textarea when it's created,\n        // and need to stay as long as the textarea exists in the DOM\n        textAreaElement.addEventListener('paste', this.paste.bind(this));\n    }\n\n    paste(e) {\n        if (e.clipboardData && e.clipboardData.items) {\n            const items = e.clipboardData.items;\n\n            const files = [];\n\n            for (let i = 0; i < items.length; i++) {\n                if (items[i].type.indexOf('image') !== -1) {\n                    files.push(items[i].getAsFile());\n                }\n            }\n\n            if (files.length > 0) {\n                e.preventDefault();\n\n                this.upload(files);\n            }\n        }\n    }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport icon from 'flarum/helpers/icon';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\nimport ReplyComposer from 'flarum/components/ReplyComposer';\nimport EditPostComposer from 'flarum/components/EditPostComposer';\nimport Stream from 'flarum/utils/Stream'\n\nexport default class UploadButton extends Component {\n    oninit(vnode) {\n        super.oninit(vnode);\n        // initial state of the button\n        this.uploading = Stream(false);\n    }\n\n    view() {\n        const buttonText = this.uploading() ? app.translator.trans('fof-upload.forum.states.loading') : app.translator.trans('fof-upload.forum.buttons.attach');\n\n        return m('.Button.hasIcon.fof-upload-button.Button--icon', {\n            className: this.uploading() ? 'uploading' : '',\n        }, [\n            this.uploading() ? LoadingIndicator.component({\n                size: 'tiny',\n                className: 'LoadingIndicator--inline Button-icon',\n            }) : icon('fas fa-file-upload', {className: 'Button-icon'}),\n            m('span.Button-label', buttonText),\n            m('form', [\n                m('input', {\n                    type: 'file',\n                    multiple: true,\n                    onchange: this.process.bind(this),\n                }),\n            ]),\n        ]);\n    }\n\n    /**\n     * Process the upload event.\n     *\n     * @param e\n     */\n    process(e) {\n        // get the file from the input field\n        const files = this.$('input').prop('files');\n\n        const upload = this.attrs.upload;\n\n        upload(files);\n    }\n\n    /**\n     * Appends the file's link to the body of the composer.\n     */\n    success() {\n        console.log('success hit')\n        // Scroll the preview into view\n        // We don't call this.textAreaObj.props.preview() because that would close the composer on mobile\n        // Instead we just directly perform the same scrolling and skip the part about minimizing the composer\n        if (app.composer.component instanceof ReplyComposer) {\n            m.route.set(app.route.discussion(app.composer.component.props.discussion, 'reply'));\n        }\n\n        if (app.composer.component instanceof EditPostComposer) {\n            m.route.set(app.route.post(app.composer.component.props.post));\n        }\n\n        // reset the button for a new upload\n        setTimeout(() => {\n            this.$('form')[0].reset();\n            this.uploading(false);\n            m.redraw();\n        }, 1000);\n    }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport Post from 'flarum/components/Post';\n\n/* global $ */\n\nexport default function () {\n    extend(Post.prototype, 'config', function (isInitialized) {\n        if (isInitialized) return;\n\n        this.$('[data-fof-upload-download-uuid]').unbind('click').on('click', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (!app.forum.attribute('fof-upload.canDownload')) {\n                alert(app.translator.trans('fof-upload.forum.states.unauthorized'));\n                return;\n            }\n\n            let url = app.forum.attribute('apiUrl') + '/fof/download';\n\n            url += '/' + e.currentTarget.dataset.fofUploadDownloadUuid;\n            url += '/' + this.props.post.id();\n            url += '/' + app.session.csrfToken;\n\n            window.open(url);\n        });\n    });\n}\n","export default class Uploader {\n    constructor() {\n        this.callbacks = {\n            'success': [],\n            'failure': [],\n            'uploading': [],\n            'uploaded': []\n        };\n    }\n\n    on(type, callback) {\n        this.callbacks[type].push(callback);\n    }\n\n    dispatch(type, response) {\n        this.callbacks[type].forEach(callback => callback(response));\n    }\n\n    upload(files) {\n        this.dispatch('uploading', files);\n\n        m.redraw(); // Forcing a redraw so that the button also updates if uploadFiles() is called from DragAndDrop or PasteClipboard\n\n        const body = new FormData;\n\n        for (let i = 0; i < files.length; i++) {\n            body.append('files[]', files[i]);\n        }\n\n        // send a POST request to the api\n        return app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/fof/upload',\n            // prevent JSON.stringify'ing the form data in the XHR call\n            serialize: raw => raw,\n            body\n        })\n            .then(this.uploaded.bind(this));\n    }\n\n    uploaded(files) {\n        files.forEach(file => this.dispatch('success', file));\n\n        this.dispatch('uploaded');\n    }\n}\n","import app from 'flarum/app';\n\nimport downloadButtonInteraction from './downloadButtonInteraction';\nimport addUploadButton from './addUploadButton';\n\napp.initializers.add('fof-upload', () => {\n    addUploadButton();\n    downloadButtonInteraction();\n});\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/EditPostComposer'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/Post'];","module.exports = flarum.core.compat['components/ReplyComposer'];","module.exports = flarum.core.compat['components/TextEditor'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['utils/Stream'];"],"sourceRoot":""}